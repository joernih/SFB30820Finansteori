<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Finansteori (SFB30820), Eksamen Høsten 2020</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="sfb-finansteori-2020_files/libs/clipboard/clipboard.min.js"></script>
<script src="sfb-finansteori-2020_files/libs/quarto-html/quarto.js"></script>
<script src="sfb-finansteori-2020_files/libs/quarto-html/popper.min.js"></script>
<script src="sfb-finansteori-2020_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="sfb-finansteori-2020_files/libs/quarto-html/anchor.min.js"></script>
<link href="sfb-finansteori-2020_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="sfb-finansteori-2020_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="sfb-finansteori-2020_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="sfb-finansteori-2020_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="sfb-finansteori-2020_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="css/ON.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#oppgave-1-porteføljeteori-teller-30-prosent" id="toc-oppgave-1-porteføljeteori-teller-30-prosent" class="nav-link active" data-scroll-target="#oppgave-1-porteføljeteori-teller-30-prosent">Oppgave 1: Porteføljeteori (Teller 30 prosent)</a></li>
  <li><a href="#oppgave-2-obligasjoner-teller-20-prosent" id="toc-oppgave-2-obligasjoner-teller-20-prosent" class="nav-link" data-scroll-target="#oppgave-2-obligasjoner-teller-20-prosent">Oppgave 2: Obligasjoner (Teller 20 prosent)</a></li>
  <li><a href="#oppgave-3-capm-og-porteføljer-teller-30-prosent" id="toc-oppgave-3-capm-og-porteføljer-teller-30-prosent" class="nav-link" data-scroll-target="#oppgave-3-capm-og-porteføljer-teller-30-prosent">Oppgave 3: CAPM og porteføljer (Teller 30 prosent)</a></li>
  <li><a href="#oppgave-4-emisjoner-og-tegningsretter-teller-10-prosent" id="toc-oppgave-4-emisjoner-og-tegningsretter-teller-10-prosent" class="nav-link" data-scroll-target="#oppgave-4-emisjoner-og-tegningsretter-teller-10-prosent">Oppgave 4: Emisjoner og tegningsretter (Teller 10 prosent)</a></li>
  <li><a href="#oppgave-5-opsjoner-teller-10-prosent" id="toc-oppgave-5-opsjoner-teller-10-prosent" class="nav-link" data-scroll-target="#oppgave-5-opsjoner-teller-10-prosent">Oppgave 5: Opsjoner (Teller 10 prosent)</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Finansteori (SFB30820), Eksamen Høsten 2020</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="oppgave-1-porteføljeteori-teller-30-prosent" class="level1">
<h1>Oppgave 1: Porteføljeteori (Teller 30 prosent)</h1>
<p>De to kameratene Lars og Sigurd har begge investert i aksjen til oljeselskapet Star Oil og i aksjen til reiselivsbedriften Travel. Lars sin forventede porteføljeavkastning er 9 prosent og Sigurd har en forventet porteføljeavkastning på 6,5 prosent. De to aksjene har følgende karakteristika: Travel Star oil Forventet avkastning 6 13 Avkastningens standardavvik 10 18 Korrelasjonskoeffisienten mellom avkastningen på de to aksjene er null.</p>
<ol type="a">
<li>Hva er den initiale porteføljestrukturen til Lars?</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span><span class="math display">\[
0.09 = 0.06w + 0.13(1-w) \\
0.06w-0.13w = 0.09 -0.13 \\
-0.07w = -0.04 \\
w = 0.04/0.07 \\
w = 0.5714
\]</span></p>
</div>
<ol start="2" type="a">
<li>Hva er den initiale porteføljestrukturen til Sigurd?</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span></p>
<!-- 0.065 = 0.0*0.928 + 0.13*(1-0.928) -->
<p><span class="math display">\[
0.065 = 0.06w + 0.13(1-w) \\
0.06w-0.13w = 0.065 -0.13 \\
-0.07w = -0.065 \\
w = 0.065/0.07 \\
w = 0.928
\]</span></p>
</div>
<ol start="3" type="a">
<li>Hva er de risikominimerende porteføljeandelene i en portefølje som består av aksjer i selskapene Star Oil og Travel?</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span><span class="math display">\[
Min _w Var(r_p) = w^2\cdot 10^2 + (1-w)^2\cdot 18^2 \\
\text{første ordens betingelsen} \\
200 w - 648 (1 - w) = 0 \\
w = 81/106 = 0.76
\]</span></p>
</div>
<ol start="4" type="a">
<li>Hva er gevinstene for Lars og Sigurd ved å effektivisere sine porteføljer? Gi en verbal forklaring på hvordan de to kameratene kan ha ulik effekt på forventet porteføljeavkastning når de effektiviserer sine porteføljer</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Det å gå mot en effisient portefølje er kjennetegnet ved at Lars eller Sigrud kan oppnå en gevinst form av økt forventet avkastning og/eller få redusert sin risiko ved å endre sin porteføljesammensetning. Når det er oppnådd, vil det være graden av risikoaversjon som vil være bestemmende for hvilket sett man vil velge, og derfor kunne forklare hvorfor effekten på forventet avkastning vil være forskjellig mellom Lars og Sigurd.</p>
</div>
</section>
<section id="oppgave-2-obligasjoner-teller-20-prosent" class="level1">
<h1>Oppgave 2: Obligasjoner (Teller 20 prosent)</h1>
<p>På Seychellene har myndighetene investert betydelig i havneområdet og utviklet en dyphavn som både kan to imot cruiseskip og containerskip, og slik legger til rette både for økt turisme og økt vareeksport. De har finansiert investeringene med 3 obligasjonslån med følgende karakteristika: Lån Pålydende (Tall i mill.) Kupongrente Gjenværende Løpetid (År) A 300 4 2 B 300 4 3 C 300 5 3 Samtidig ser rentekurven ut som følger: Spotrente år 1 Spotrente år 2 Spotrente år 3 6 6 6<br>
2</p>
<ol type="a">
<li>Anta at obligasjoner prises med en standard nåverditilnærming. Hva er dagens markedspris på de tre obligasjonene?</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span><span class="math display">\[\begin{equation*}
P_{0,A} = \frac{300\cdot 0.04}{(1+0.06)^{1}} + \frac{300\cdot 0.04}{(1+0.06)^{2}} + \frac{300}{(1+0.06)^3} =  288.9996
\end{equation*}\]</span> <span class="math display">\[\begin{equation*}
P_{0,B} = \frac{300\cdot 0.04}{(1+0.06)^{1}} + \frac{300\cdot 0.04}{(1+0.06)^{2}} + \frac{300\cdot   0.04}{(1+0.06)^{3}}+\frac{300}{(1+0.06)^3}  = 283.9619  
\end{equation*}\]</span> <span class="math display">\[\begin{equation*}
P_{0,C} = \frac{300\cdot 0.05}{(1+0.06)^{1}} + \frac{300\cdot 0.05}{(1+0.06)^{2}} + \frac{300\cdot 0.05}{(1+0.06)^{3}}+\frac{300}{(1+0.06)^3}  = 251.88
\end{equation*}\]</span></p>
</div>
<p>På Seychellene er det to store obligasjonsfond, Korallen og Palmen. Obligasjonsfondet Palmen har et avkastningskrav på 7 prosent. Obligasjonsfondet Korallen har et avkastningskrav på 3 prosent. De to fondene har mulighet til å investere i to null-kupong obligasjoner som begge har pålydende 100 euro. Obligasjon A har en løpetid på 3 år og handles i dag til en pris på 87,63 euro. Obligasjon B har en løpetid på 2 år og handles i dag til en pris på 87,34 euro.</p>
<ol start="2" type="a">
<li>Hvilke (om noen) av disse to obligasjonene vil de to fondene Palmen og Korallen investere i ?</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Obligasjon A <span class="math display">\[
87.63=\frac{100}{(1+r)^3}  \Leftrightarrow \\
(1+r)^3=\frac{100}{87.63} \\
(1+r)=(\frac{100}{87.63})^{1/3}=1.044999
\]</span></p>
</div>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Obligasjon B <span class="math display">\[
87.34=\frac{100}{(1+r)^2}  \Leftrightarrow \\
(1+r)^2=\frac{100}{87.34} \\
(1+r)=(\frac{100}{87.34})^{1/2}=1.068252
\]</span> <br> Palmen krav 7 prosent, hverken obligasjon A eller B siden ingen er høyere enn avkastningskravet. <br> Koralen krav 3 prosent, både obligasjon A og B tilfredstiller avkastningskravet, men B har høyest, vil derfor investere alt der.</p>
</div>
<ol start="3" type="a">
<li>Gi en verbal forklaring på forholdet mellom pålydende verdi og markedspris på både null-kupong obligasjoner og på kupong obligasjoner.</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>-Null-kupong: Hvor mange ganger mer man får betalt tre år fram i tid (i form av restbeløpet) ved å investere én krone i dag.</p>
<p>-Kupong obligasjoner: Hvor mange ganger mer man får betalt i løpet av obligasjonenss løpetid (i form av kupongrente og restbeløp) ved å investere én krone i dag.</p>
</div>
</section>
<section id="oppgave-3-capm-og-porteføljer-teller-30-prosent" class="level1">
<h1>Oppgave 3: CAPM og porteføljer (Teller 30 prosent)</h1>
<ol type="a">
<li>Gi en verbal forklaring på hva som menes med kapitalverdimodellen (CAPM). Kommenter spesielt hvilken rolle risikofrirente spiller i kapitalverdimodellen. Anta at forutsetningene som ligger til grunn for CAPM holder.</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Kapitalverdimodellen (KVM) er en modell til prisetting av risiko (forholdet mellom systemtatisk risiko og kapitalkost). Vi bruker KVM til å finne avkastningskravet til investeringer som inneholder risiko. Det er naturlig at investoren skal kompenseres for risikofri rente og selve risikoen som følger med investeringen. Risikofri rente er lang statsobligasjon (typisk 10 år) eller historisk risikofri realrente. Det er med andre ord den renten du får uten noe som helst risiko. Beta-koeffisient er markedets systematiske risiko. Altså den risikoen vi ikke får diversifisert bort. Det kan være nedgangstider, manglende likviditet og markedskollaps.</p>
</div>
<p>I aksjemarkedet på Færøyene er forventet avkastning på markedsporteføljen kommende periode 9 prosent, mens tilhørende standardavvik er 12 prosent. Forventet avkastning på aksjer i Fiskeoppdrett-selskapet Beidarin er 12 prosent, mens tilhørende standardavvik er 15 prosent. Risikofri rente på Færøyene er 3 prosent med tilhørende standardavvik på 0 prosent.</p>
<ol start="2" type="a">
<li>Hva må du gjøre for å oppnå forventet avkastning på 8 prosent på din porteføljeplassering i følgende tilfeller:</li>
</ol>
<ol type="1">
<li>Markedsporteføljen kombineres med risikofri posisjon</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span><span class="math display">\[
0.08 = w0.03 + (1-w)0.09 \\
w(0.03-0.09) = 0.08-0.09 \\
w(0.06) = 0.01 \\
w = 0.01/0.06 = 0.01/0.06 = 0.1667
\]</span></p>
</div>
<ol start="2" type="1">
<li>Aksjer i Beidarin kombineres med risikofri posisjon</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span><span class="math display">\[
0.08 = w0.03 + (1-w)0.12 \\
w(0.03-0.12) = 0.08-0.12 \\
w(0.09) = 0.04 \\
w = 0.04/0.09 = 0.44
\]</span></p>
</div>
<ol start="3" type="a">
<li>Finn standardavvik og beta verdien til porteføljen i de to tilfellene beskrevet over. Gi en verbal forklaring på hvorfor de to risikomålene varierer mellom de to porteføljene.</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Standardavviket er gitt ved <span class="math display">\[
Std(r_m) = (1-0.1665)12 = 10\\
Std(r_b) = (1-0.44)15 = 8.33
\]</span></p>
<p>Selskapets beta fremkomer som <span class="math display">\[
0.12=0.03+\beta_b\cdot (0.09-0.03) \Leftrightarrow \\
\beta_b = (0.12-0.03)/(0.09-0.03) = 1.5
\]</span> Mens markedsporteføljens alltid vil være <span class="math display">\[
\beta_m =1
\]</span></p>
</div>
<ol start="4" type="a">
<li>Anta at Beidarin aksjen i dag handles for 190 kroner. Hvis beta verdien på Beidarin aksjen er 1,5 hvilken kurs vil du predikerer på Beidarin aksjen om ett år?</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Vi har følgende sammenheng <span class="math display">\[
(P_1-190)/190=0.12 \Leftrightarrow \\
P_1=1.12\cdot190 = 212
\]</span></p>
</div>
<ol start="5" type="a">
<li>Anta at utviklingen i økonomien svekkes slik at risikofrirente faller til 1 prosent.<br>
Hvordan påvirker det predikert kurs på Beidarin aksjen? Gi en verbal forklaring på hvorfor predikert aksjekurs på Beidarin aksjen endres av at risikofrirente faller.</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Den forventede avkastningen øker fra 0.12 til <span class="math display">\[
0.13=0.01+1.5\cdot(0.09-0.01)
\]</span> Noe som betyr at aksjekursen øker. Risikpremien øker, og siden beta større enn 1 fører høere risikokrav</p>
</div>
</section>
<section id="oppgave-4-emisjoner-og-tegningsretter-teller-10-prosent" class="level1">
<h1>Oppgave 4: Emisjoner og tegningsretter (Teller 10 prosent)</h1>
<p>Selskapet Nordic Oil har i dag en egenkapital på 1 500 000 kroner og aksjekursen er i dag 15 kroner, og det er tidligere utstedt 100 000 aksjer. Selskapet skal nå hente inn 500 000 i ny aksjekapital ved å utstede 50 000 nye aksjer til en emisjonskurs på 10 kr.</p>
<ol type="a">
<li>Finn verdien av en tegningsrett i emisjonen til Nordic Oil.</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span><span class="math display">\[
N = n/m = 100000/50000 = 2 \\
T_x = \frac{15-10}{2+1} = 5/3 = 1.666
\]</span></p>
</div>
<ol start="2" type="a">
<li>Gi en verbal forklaring på hvorfor emisjonskursen ikke har betydning for aksjonærverdiene til gamle aksjonærer i Nordic Oil når aksjonærene selger sine tegningsretter.</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Verdien av tegningsrettigheten vil nøyaktig tilsvare kursfallet etter at tegningsrettigheten er utløpt. Gamle aksjonærers formue vil derfor være helt upåvirket av emisjonen såframt man selger tegningsrettigheten i markedet.</p>
</div>
</section>
<section id="oppgave-5-opsjoner-teller-10-prosent" class="level1">
<h1>Oppgave 5: Opsjoner (Teller 10 prosent)</h1>
<p>Du er ansatt som økonomisjef i det private oljeselskapet Norway Oil, hvor hoveddelen av inntekten er relatert til salget av råolje som prises i USD. Selskapet har hovedkontor og produksjon i Norge. Det er du som tar beslutningen om deler av oljeproduksjonen skal sikres eller ikke ved hjelp av derivater.</p>
<ol type="a">
<li>Gi en verbal tolkning av hvilke risikofaktorer selskapet er eksponert mot</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span></p>
<ul>
<li>Valutakursrisiko siden salg av råolje er priset i USD.</li>
<li>Prisrsiko siden prisen på råolje (råvare) typisk vil ha sterke svingninger over tid.</li>
</ul>
</div>
<ol start="2" type="a">
<li>Du har forhandlet deg frem til en solid bonusavtale basert på neste års resultat. Gitt at du bare tenker på deg selv, forklar om du ville valgt å sikre mye eller lite av oljeproduksjonen. Ville dette valget endret seg om bonusen var basert på snittet av resultatet for de neste fem årene?</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span></p>
<ul>
<li>Ett år: Sikre lite av oljeproduksjonen, det kan gi svært høy bonus dersom prisrisikokompnentene gir høy inntekt, og ingen intekt dersom prisrisikokompnentene går i motsatt retning.\</li>
<li>Fem år: Siden snittet vil avhenge av alle fem år, vil det kunne være fordelaktig å unngå konkur i løpet av perioden. Dette kan gjøres ved å sikre mer.</li>
</ul>
</div>
<ol start="3" type="a">
<li>Etter en grundig analyse, velger du kun å sikre deg mot oljeprisnedgang. Hvilke derivater ville du vurdert? Og hva vil hovedkriteriene for det endelige valget av derivat være?</li>
</ol>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Finansielle derivater gjenomgått i dette kurset som påvirker kontantstrømmen består av.</p>
<ul>
<li>Opsjoner</li>
<li>Futures</li>
<li>Forwards</li>
<li>Swaps</li>
</ul>
<p>Kriteriet for det endelig valget: Asymetrisk, dvs. oppnå en positiv kontantstrøm fra derivatetet i det tilfelle det underliggende objektet i form av råoljeprisen går ned. Kan gjørs ved en salgsopsjon på råoljeprisen, <span class="math inline">\(Max(0,I-O_T)\)</span>. Eventuelt sikre dette i form futurekontrakt på valutakursen.</p>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>