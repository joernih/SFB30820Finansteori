cov.wt                  package:stats                  R Documentation

_W_e_i_g_h_t_e_d _C_o_v_a_r_i_a_n_c_e _M_a_t_r_i_c_e_s

_D_e_s_c_r_i_p_t_i_o_n:

     Returns a list containing estimates of the weighted covariance
     matrix and the mean of the data, and optionally of the (weighted)
     correlation matrix.

_U_s_a_g_e:

     cov.wt(x, wt = rep(1/nrow(x), nrow(x)), cor = FALSE, center = TRUE,
            method = c("unbiased", "ML"))
     
_A_r_g_u_m_e_n_t_s:

       x: a matrix or data frame.  As usual, rows are observations and
          columns are variables.

      wt: a non-negative and non-zero vector of weights for each
          observation.  Its length must equal the number of rows of
          ‘x’.

     cor: a logical indicating whether the estimated correlation
          weighted matrix will be returned as well.

  center: either a logical or a numeric vector specifying the centers
          to be used when computing covariances.  If ‘TRUE’, the
          (weighted) mean of each variable is used, if ‘FALSE’, zero is
          used.  If ‘center’ is numeric, its length must equal the
          number of columns of ‘x’.

  method: string specifying how the result is scaled, see ‘Details’
          below.  Can be abbreviated.

_D_e_t_a_i_l_s:

     By default, ‘method = "unbiased"’, The covariance matrix is
     divided by one minus the sum of squares of the weights, so if the
     weights are the default (1/n) the conventional unbiased estimate
     of the covariance matrix with divisor (n - 1) is obtained.  This
     differs from the behaviour in S-PLUS which corresponds to ‘method
     = "ML"’ and does not divide.

_V_a_l_u_e:

     A list containing the following named components:

     cov: the estimated (weighted) covariance matrix

  center: an estimate for the center (mean) of the data.

   n.obs: the number of observations (rows) in ‘x’.

      wt: the weights used in the estimation.  Only returned if given
          as an argument.

     cor: the estimated correlation matrix.  Only returned if ‘cor’ is
          ‘TRUE’.

_S_e_e _A_l_s_o:

     ‘cov’ and ‘var’.

_E_x_a_m_p_l_e_s:

      (xy <- cbind(x = 1:10, y = c(1:3, 8:5, 8:10)))
      w1 <- c(0,0,0,1,1,1,1,1,0,0)
      cov.wt(xy, wt = w1) # i.e. method = "unbiased"
      cov.wt(xy, wt = w1, method = "ML", cor = TRUE)
     

